@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
  @*  <meta name="viewport" content="width=device-width" />*@
       <title>Mower Helper-Find an Mower Helper</title>
      @Styles.Render("~/Content/styles")
             @Styles.Render("~/Content/themes/base/TherpistStyles")
                 @Scripts.Render("~/Scripts/Thscriptscript")
     <link href="~/Content/themes/base/jquery.ui.autocomplete.css" rel="stylesheet" type="text/css" />
                          <script type="text/javascript">
                              $(document).ready(function () {
                                  $("#txtTitle1").val("@ViewBag.title");
                                  var TopIndex = '@Session["TopIndex"]';
                                  $("#Menu0").removeClass();
                                  $("#Menu1").removeClass();
                                  $("#Menu2").removeClass();
                                  $("#Menu3").addClass("active");
                                 
                              });

   </script>
    <script type="text/javascript">
        $.ajaxSetup({ cache: false });
        $(function () {

            $('#playvideodialog').dialog({
                autoOpen: false,
                width: 800,
                height: 500,
                resizable: false,
                modal: true,
                buttons: [{

                    text: "Cancel",
                    "class": 'button',
                    click: function () {

                        $(this).dialog("close");
                    }

                }
                ]
            });

            //$(".Playvideofile").click(function () {
            //    //change the title of the dialog
            //    linkObj = $(this);
            //    var dialogDiv = $('#playvideodialog');
            // //   $('#dvLoading').dialog({ modal: true, dialogClass: 'dvLoading', draggable: false, resizable: false });
            //    // alert(dialogDiv);
            //    var viewUrl = linkObj.attr('href');
            //    // alert(viewUrl);
            //    $.get(viewUrl, function (data) {
            //        dialogDiv.html(data);
            //       // $('#dvLoading').dialog('close');
            //        dialogDiv.dialog('open');
            //    });
            //    return false;
            //});
        });
        $(function () {
            //   $("#txt_ToDate,#txt_FromDate").datepicker({
            //    dateFormat: 'mm/dd/yy',
            //    changeMonth: true,
            //    changeYear: true,
            //    //                showCurrentAtPos: 1,
            //    showWeeks: true,
            //    inline: true,
            //    numberOfMonths: [1, 1],
            //    yearRange: "1950:2020",
            //    showOn: "button",
            //    buttonImage: "../Images/calender.gif",
            //    buttonImageOnly: true

            //});
            //$("#txt_FromDate").on('change keyup paste mouseup', function () {
            //    //  alert("1");
            //    if ($(this).val().length == 10) {
            //        //alert("2");
            //        if (CheckValidDate(document.getElementById('txt_FromDate')) == 0) { return false; }
            //        var St = document.getElementById('txt_FromDate').value; St = new Date(St);
            //        // alert(St);
            //        var targetDate = new Date(St);
            //        targetDate.setDate(targetDate.getDate() + 365);
            //        //   alert(targetDate);
            //        var todaydate = new Date();
            //        todaydate.setDate(todaydate.getDate());
            //        var dd = todaydate.getDate();
            //        var mm = todaydate.getMonth() + 1; //January is 0!
            //        var yyyy = todaydate.getFullYear();
            //        var today = mm + '/' + dd + '/' + yyyy;
            //        var dd1 = targetDate.getDate();
            //        var mm1 = targetDate.getMonth() + 1;
            //        var yyyy1 = targetDate.getFullYear();
            //        var target1 = mm1 + '/' + dd1 + '/' + yyyy1;
            //        //  alert(target1);
            //        if (targetDate > todaydate) { document.getElementById('txt_ToDate').value = today; return false; }
            //        else { document.getElementById('txt_ToDate').value = target1; return false; }
            //    }
            //});
        });
    </script>
   <script type="text/javascript">
       $(function () {
          
           $('#imgbtnDcancel').click(function () {

               window.location.href = "@Url.Action("ArticlesVideos","AdminHome")";
           });
       });

   </script>
      <script type="text/javascript">

          $(document).ready(function () {
              var frm = $("#formname");
              $('#dt_filter').change(function () {
                  if (document.getElementById('dt_filter').value == 'Custom') {
                      document.getElementById('tddaterange').style.display = '';
                      $('#txt_FromDate').val("");
                      $('#txt_ToDate').val("");
                  }
                  else {
                      document.getElementById('tddaterange').style.display = 'none';
                      $('#txt_FromDate').val("");
                      $('#txt_ToDate').val("");
                  }
                  return false;
              });
              var fromdate = $('#hdnFromdate').val();
              if (fromdate != '') {
                  $('#txt_FromDate').val(fromdate);
                  document.getElementById('tddaterange').style.display = '';
              }
              else {
                  $('#txt_FromDate').val("");
                  document.getElementById('tddaterange').style.display = 'none';

              }

              var todate = $('#hdnTodate').val();
              if (todate != '') {
                  $('#txt_ToDate').val(todate);
                  document.getElementById('tddaterange').style.display = '';
              }
              else {
                  $('#txt_ToDate').val("");
                  document.getElementById('tddaterange').style.display = 'none';

              }

              var drange = $('#hdndaterange').val();
              if (drange != '') {
                  $('#dt_filter').val(drange);

              }
              else {
                  $('#dt_filter').val("0");


              }

          });

</script>
        <script  type="text/javascript">
            function CancelAction() {
                window.location.href = "../AdminHome/ArticlesVideos";
            }
            function ValidSearch() {

                if (document.getElementById('dt_filter').selectedIndex == 0) {
                    alert("Select date");
                    return false;
                }
                if (document.getElementById('dt_filter').value == 'Custom') {

                    if (document.getElementById('txt_FromDate').value != '' && document.getElementById('txt_FromDate').value != "mm/dd/yyyy") {
                        if (CheckValidDate(document.getElementById('txt_FromDate')) == 0) {
                            return false;
                        }
                    }
                    if (document.getElementById('txt_ToDate').value != '' && document.getElementById('txt_ToDate').value != "mm/dd/yyyy") {
                        if (CheckValidDate(document.getElementById('txt_ToDate')) == 0) {
                            return false;
                        }
                    }
                    var CDate = new Date()
                    var CFormatDate = CDate.getUTCMonth() + 1 + "/" + CDate.getDate() + "/" + CDate.getFullYear();
                    var FromDate = document.getElementById('txt_FromDate').value;
                    if (document.getElementById('txt_FromDate').value == '' || document.getElementById('txt_FromDate').value == "mm/dd/yyyy") {
                        alert('Select from date');
                        document.getElementById('txt_FromDate').focus();
                        return false;
                    }
                    if (document.getElementById('txt_ToDate').value == '' || document.getElementById('txt_ToDate').value == "mm/dd/yyyy") {
                        alert('Select to date');
                        document.getElementById('txt_ToDate').focus();
                        return false;
                    }
                    var St = document.getElementById('txt_FromDate').value;
                    St = new Date(St);
                    var En = document.getElementById('txt_ToDate').value
                    En = new Date(En);
                    if (St > En) {
                        alert("From date should not be greater than to date")
                        return false;
                    }

                }
               // document.forms.item(0).submit();
               //localhost:49219/Admin/publicvideos?imgbtnUcancel=Cancel&imgbtnDcancel=Cancel
                if ($("#dt_filter").val() == "Custom") {

                    window.location.href = "../Admin/publicvideos?txtTitle1=" + $("#txtTitle1").val() + "&dt_filter=" + $('#dt_filter').val() + "&imgbtnUcancel=" + $("#imgbtnUcancel").val() + "&txt_FromDate=" + $('#txt_FromDate').val() + "&txt_ToDate=" + $("#txt_ToDate").val() + "&imgbtnDcancel=" + $("#imgbtnDcancel").val();// + "&ddlrecords=" + $("#ddlrecords").val();
                }
                    //  if ($("#dt_filter").val() != "Custom") {
                else {

                    window.location.href = "../Admin/publicvideos?txtTitle1=" + $("#txtTitle1").val() + "&dt_filter=" + $('#dt_filter').val() + "&imgbtnUcancel=" + $("#imgbtnUcancel").val() + "&imgbtnDcancel=" + $("#imgbtnDcancel").val();//+ "&ddlrecords=" + $("#ddlrecords").val();
                }
            }

    </script>
        <style type="text/css">
        .ui-datepicker-trigger
        {
            margin-left: 5px;
            vertical-align: middle;
        }
    </style>
     <script type="text/javascript">
         $(function () {
             JqAutocomplete1('TitleList', 'txtTitle1');
         
         });
    </script>
</head>
<body>
   @using (Html.BeginForm("publicvideos", "Admin", null, FormMethod.Get, new { @enctype = "multipart/form-data" }))
   {
         <input id="hdnFromdate" name="hdnFromdate" type="hidden" value="@ViewBag.Fromdate"/>
        <input id="hdnTodate" name="hdnTodate" type="hidden" value="@ViewBag.Todate"/>
        <input id="hdndaterange" name="hdndaterange" type="hidden" value="@ViewBag.Daterange"/>
  <div>
                  @{Html.RenderAction("Topsection", "Tools");}
        </div> 
     <div id="body-wrapper">
          <div id="main-content">
        @Html.Partial("_NavigationTool")
          <table cellspacing="0" cellpadding="0" width="100%" align="center">
            <tr style="background:none;">
                <td valign="top" class="paddingleft">
                    <br />
                    <table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
                        <tr style="background:none;">
                            <td>
                                <table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
                                  
                                    <tr style="background:none;">
                                        <td>
                                            <table style="width:90%; text-align:center;">
                                                <tr style="background:none;">
                                                    <td style="width:20%;">
                                                        
                                                                &nbsp;&nbsp;&nbsp;<b>Title :</b>&nbsp;
                                                               <input type="text" id="txtTitle1" name="txtTitle1" class="" style="width:180px;" />
                                                          
                                                    </td>
                                                         <td align="left" style="width:20%;" >
                                                <strong>Date range&nbsp;:&nbsp; </strong>
                                                                                    @Html.DropDownList("dt_filter", new List<SelectListItem>

                                                              {
                                                               new SelectListItem{ Text="--Select dates--", Value = "0" },
                                                               new SelectListItem{ Text="Today", Value = "Today" },
                                                               new SelectListItem{ Text="Last 7 days", Value = "7" },
                                                               new SelectListItem{ Text="Last 30 days", Value = "30" }, 
                                                               new SelectListItem{ Text="Custom", Value = "Custom" }, 
                                                              },
                                                               new { style = "font-family:arial;font-size:13px;height:20px;width:120px;" })
                        </td>
                                                     @Html.Partial("_CustomDate")
                 @*       <td id="tddaterange" runat="server" style="display:none; width:40%;" align="left">
                    <strong> From : </strong> &nbsp;&nbsp;&nbsp;  
                                                              <input type="text" name="txt_FromDate" id="txt_FromDate" class="textfield" maxlength="10" style="width: 75px;" />
                                                             &nbsp;&nbsp; <strong> To : </strong> &nbsp;&nbsp;&nbsp; 
                                                             <input type="text" name="txt_ToDate" id="txt_ToDate" class="textfield" maxlength="10" style="width: 75px;" />
                        </td>*@
                                                    <td style="text-align:right;">
                                                        &nbsp;&nbsp;
                                                   @*<input type="submit" id="imgbtnUsubmit" value="Search" class="button" onclick="return ValidSearch();" />&nbsp;*@                                                   
                                                        <a id="imgbtnUsubmit" href="#" onclick="return ValidSearch();" title="Search"><img alt="" id="" src="~/Images/search_button_green.png" style="width:30px;" /></a>&nbsp;
                                                        <input id="imgbtnUcancel" name="imgbtnUcancel" value="Cancel" class="button" style="width:40px;vertical-align:top" onclick="return CancelAction();"  />
                                                  @*      <asp:Button ID="imgbtnUsubmit" runat="server" Text="Search" class="button" />&nbsp;
                                                         <asp:Button ID="imgbtnUcancel" runat="server" Text="Cancel" class="button" />*@
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                </table><br />
                            </td>
                        </tr>
                        <tr style="background:none;">
                            <td >
                                <div class="content-box">
                                <div class="content-box-header">
                                
                                <ul class="content-box-tabs"></ul>
                                    <table width="100%" cellpadding="0" cellspacing="0" style="float: left;">
                                        <tr>
                                            <td width="70%" align="left">
                                                <h3>
                                                    Video&nbsp;list</h3>
                                            </td>
                                            <td width="17%" align="right">
                                              @*  <ul style="list-style: none!important; padding-right: 5px;" class="content-box-tabs">
                                                    <uc1:TotalRecordsPerPage ID="TotalRecordsPerPage1" runat="server"></uc1:TotalRecordsPerPage>
                                                </ul>*@
                                            </td>
                                            <td width="13%" align="left">
                                          
                                                <ul style="list-style: none!important; padding-right: 5px;" class="content-box-tabs">
                                                <li>
                                                 <a id="lnkAddNew" href="@Url.Action("AddNewVideo", "Admin")" style="color:#0066CC; font-size:15px;"><b>Add video</b></a>
                                                </li>
                                               @*     <asp:LinkButton ID="lnkAddNew" ForeColor="#0066CC" Font-Bold="false" Font-Size="15px"
                                                        runat="server"><b>Add media</b></asp:LinkButton>*@
                                                </ul>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                               <div class="content-box-content">
                                            @{string heading1;
                                              if (Request["sort"] == "Item" && Request["sortdir"] == "ASC")
                                              {
                                                  heading1 = "Item ▲";
                                              }
                                              else if (Request["sort"] == "Item" && Request["sortdir"] == "DESC")
                                              {
                                                  heading1 = "Item ▼";
                                              }
                                              else
                                              {
                                                  heading1 = "Item .";
                                              }
                                            }
                                            @{string expsize = (ViewBag.expsize == null ? "10" : ViewBag.expsize);
                                              WebGrid Expgrid = new WebGrid(rowsPerPage: Convert.ToInt32(expsize));}
                                            @{WebGrid grid = Expgrid.Bind(rowCount: Convert.ToInt32(ViewBag.totrec), source: Model, autoSortAndPage: false);
                                              if (grid.TotalRowCount != 0)
                                              {

                                                  string pager = grid.Pager().ToString();
                                                  //int count = 0;
                                                  string pageno = (Request["page"] == null ? "1" : Request["page"]);
                                                  string newpager = System.Text.RegularExpressions.Regex.Replace(pager, "(\\d+) ", "<span class='selected'>" + pageno + "</span>");
                                                  string gridhtml = grid.GetHtml(tableStyle: "gridTable", headerStyle: "gridHead", rowStyle: "gridRow", alternatingRowStyle: "gridAltRow",
                                                  columns: grid.Columns(grid.Column("Title", "Title", canSort: false),
                                                  grid.Column("FILENAME", "File Name", canSort: false,format:@<text>
                                           @*@Html.ActionLink("Youtube Video", "Playvideo", "Admin", new { id=item.PublicVideo_ID }, new { @class="Playvideofile",@title="Click here to play the video"})*@
                                            <a href="#" title="Click here to play the video" class="Playvideofile" onclick="return Displaydialog('playvideodialog','@Url.Action("Playvideo", "Admin", new { id=item.PublicVideo_ID })',500,800,'dvLoading',null,null);">Youtube Video</a>
                                            </text>),
                                                  grid.Column("Online_ind", "Show online", canSort: false,format:@<text>
                                            @{
                                                string onind=null;
                                                if(item.Online_ind=="Y"){
                                                    onind="Yes";
                                                }
                                                else{
                                                    onind="No";
                                                }
                                            }
                                            <span>@onind</span>
                                                  </text> ),
                                                  
                                                               grid.Column("", "Edit", canSort: false,
                                                  format:@<text>
                                           
                                            @Html.ActionLink(" ", "EditPublicVideo", new {videoid=Convert.ToInt32(item.PublicVideo_ID)},
          new { @style = "background: url('../Images/edit.gif') no-repeat ;height: 40px;width:30px;padding-left:20px;padding-bottom:15px;", @title = "Click here to Edit" })</text>),
                                             grid.Column("", "Delete", canSort: false,style: "date",
                                                  format:@<text>@Html.ActionLink(" ", "DeletePublicvideo", new { id=item.PublicVideo_ID },
                                                  new { @style = "background: url('../Images/cross.png') no-repeat ;height: 15px;padding-left:15px;", @class = "confirmDialog", @title = "Click here to delete expenses" })</text>)

                                                 )).ToString();
                                                  gridhtml = System.Text.RegularExpressions.Regex.Replace(gridhtml, "<tfoot>([^<]*|<[^/]*|</[^t]*)*</tfoot>", "");
                                                @(new HtmlString(gridhtml))
                                                <br />
                                                <div class="gridFooter" style="padding-left: 500px;">@(new HtmlString(newpager))</div>  
                                                <br />



                                              }
                                              else
                                              {
                                                <table id="tblMsg" cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
                                                    <tr id="trcpterror" class="white_color">
                                                        <td align="center" height="25px" valign="middle" colspan="2">
                                                            <span id="lbl_NoRecordMsg" class="errormsg" style="font-size: 13px; font-weight: bold;">
                                                                No videos found</span>
                                                        </td>
                                                    </tr>
                                                </table>
                                              }
                                            }
                                        </div>

                         <table cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
                        <tr style="background:none;">
                            <td style="height: 50px">
                                <table cellspacing="0" cellpadding="0" width="98%" align="center" border="0">
                                    
                                    <tr style="background:none;">
                                        <td align="right">
                                         <input id="imgbtnDcancel" name="imgbtnDcancel" value="Cancel" class="button" style="width:40px;" />
                                          
                                            </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </div></div>
    <div>
   @*  <div id="dvLoading" style="display:none; text-align:center; vertical-align:middle">
     <img src="../Images/ajax-loader2.gif" alt="Processing"  />
    </div>*@
        <div id="AddNewMedia" title="Add New Media"></div>
             @{Html.RenderAction("Bottomsections", "Tools");}

        </div>
       <div id="Videoplay"></div>
               <div id="playvideodialog" title="Playing Video File"></div>
        <div id="dialog-confirmvideo" title="Mower Helper" style="display: none;">
        <p>
            <span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 20px 0;"></span>
            Do you want to delete the Video?
        </p>
    </div>
   }
</body>
<script type="text/javascript">
    $(".confirmDialog").live("click", function (e) {

        var url = $(this).attr('href');
        $("#dialog-confirmvideo").dialog({
            autoOpen: false,
            height: 170,
            width: 350,
            show: { effect: 'drop', direction: "up" },
            modal: true,
            buttons: {
                "Yes": function () {
                    $(this).dialog("close");
                    window.location = url;

                },
                "No": function () {
                    $(this).dialog("close");

                }
            }
        });
        $("#dialog-confirmvideo").dialog('open');
        return false;
    });
  
        </script>
<script src="~/Scripts/DatepickerNew.js" type="text/javascript"></script>
</html>


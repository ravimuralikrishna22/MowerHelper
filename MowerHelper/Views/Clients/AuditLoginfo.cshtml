@model MowerHelper.Models.BLL.Admin.LogInfo
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
@*    <meta name="viewport" content="width=device-width" />*@
   <title>Mower Helper-Find an Mower Helper</title>
    <style type="text/css">
             .dvLoading .ui-dialog-titlebar{display:none;}
    </style>
    @Styles.Render("~/Content/themes/base/jqueryCSS")
    @Scripts.Render("~/ThScripts/ThJquery")
    <script src="~/Scripts/scriptCognetwork.js"></script>
    <script type="text/javascript">
        if ('@Session["roleid"].ToString()' != "1") {
            $("#tdtabsadmin").removeClass("tab-background");               
        }
        //$(document).ready(function () {
        //    var psize = $('#hdnpagesize').val();
        //    if (psize != '') {
        //        $('#NoofRecords').val(psize);
        //    }
        //    else {
        //        $('#NoofRecords').val("10");

        //    }

        //});
    </script>
      <script type="text/javascript">

          var linkObj;
          $(function () {

              //$('#viewAudit').dialog({
              //    autoOpen: false,
              //    width: 1000,
              //    //                      height: 400,
              //    resizable: false,
              //    modal: true
              //});

              //$(".viewAuditinfo").click(function () {
              //    linkObj = $(this);
              //    var dialogDiv = $('#viewAudit');
              //    $('#dvLoading').dialog({ modal: true, dialogClass: 'dvLoading', draggable: false, resizable: false });
              //    var viewUrl = linkObj.attr('href');
              //    $.get(viewUrl, function (data) {
              //        dialogDiv.html(data);
              //        $('#dvLoading').dialog('close');
              //        dialogDiv.dialog('open');
              //    });
              //    return false;
              //});
          });
   </script>
</head>
<body>
     @using (Html.BeginForm("AuditLoginfo", "Clients", FormMethod.Get, null))
    {
    <div>
          @{Html.RenderAction("Topsection", "Tools");}
    </div>
    
            <div id="main-content">
                @if (Session["RoleID"].ToString() == "1")
                {
                    @Html.Partial("_NavigationTool") 
                }
                  @*<input id="hdnpagesize" name="hdnpagesize" type="hidden" value="@Model.NoofRecords"/>*@
                 <table width="100%" cellpadding="0" cellspacing="0">
          @*  @if (Session["roleid"].ToString() == "1")
            {
                            <tr id="trtabsadmin" runat="server">
                                <td width="100%" class="navigation">
                                    <div class="admin-tab">
                                        <a class="admin-link" id="admincust" href="ClientsHome" ><span>Customers</span>
                                        </a>
                                    </div>
                                    <div class="admin-tab">
                                        <a class="inadmin-link" id="admintask"  href="../Task/TaskList"><span>Tasks </span>
                                        </a>
                                    </div>
                                
                                    <div class="admin-tab">
                                        <a class="inadmin-link" id="adminnote" href="../Notes/ProfileNotes"><span>Notes</span>
                                        </a>
                                    </div>                               
                                </td>
                            </tr>
            }*@
                            <tr class="background_color">
                                <td id="tdtabsadmin" class="tab-background"   width="100%">
        <table width="100%" cellpadding="0" cellspacing="0" border="0">
            <tr class="background_color">
                <td align="left" valign="top" width="100%">
                    <table width="100%" cellpadding="0" cellspacing="0" border="0">
                        <tr id="trtabs">
                            <td width="100%" class="navigation">
                                <div class="admin-tab">
                                    @* @{string linktext = "Demography" + "(" + ViewBag.Patname + ")";}
                          @Html.ActionLink("<span>"+linktext+"</span>", "patientFile", "Patients", new { PatientID = Session["PatientID"] }, new { @class = "admin-link" })
                                    <a class="admin-link" href="patientFile?PatientID="+Sess id="aprovider"><span>Demography(@ViewBag.Patname )</span>
                                    </a>*@ <a class="inadmin-link" href="ClientFile" id="aprovider"><span>@Session["Patname"]</span>
                                    </a>
                                </div>
                              
                                <div class="admin-tab">
                                    <a class="inadmin-link" id="avideo" href="TransactionsList"><span>Transactions</span>
                                    </a>
                                </div>
                                 <div class="admin-tab">
                                    <a class="inadmin-link" id="astatistic" href="ClentAppointments"><span>Appointments & General notes</span>
                                    </a>
                                </div>
                                 <div class="admin-tab">
                                    <a class="inadmin-link" id="asentinvoices" href="SentInvoices"><span>Sent Invoices</span>
                                    </a>
                                </div>
                               @* <div class="admin-tab">
                                    <a class="inadmin-link" id="astatistic" href="ClientDocument"><span>Notes/Documents</span>
                                    </a>
                                </div>*@
                               @* <div class="admin-tab">
                                   
                                         <a class="inadmin-link" id="astatistic1" href="~/ProgressReports/ProfileCDProgress"><span>Appointments</span></a>
                                </div>*@
                                      <div class="admin-tab">
                                   @* <a class="inadmin-link" id="astatistic1" href="ProfileCDProgress"><span>Appointments/Progress
                                        reports</span> </a>*@
                                         <a class="admin-link" id="aauditlog" href="AuditLoginfo"><span>Audit Log</span></a>
                                </div>
                            </td>
                        </tr>
                        <tr class="background_color">
                            <td id="tdtabs" class="tab-background" width="100%">
                                <div class="content-box">
                                    <div class="content-box-header">
                                        <table width="100%" cellpadding="0" cellspacing="0" style="float: left;">
                                            <tr>
                                                <td width="80%" align="left">
                                                    <h3>
                                                        Audit log</h3>
                                                </td>
                                                 <td width="20%" align="center">
                                <ul style="list-style: none!important; padding-right: 5px; padding-top: 5px;" class="content-box-tabs">
                                    <li><strong>Rows per page :&nbsp;</strong>
                                     @*@{Html.RenderAction("Rowsperpage", "Profiles", new { @id = "1" });}*@
                                        @Html.DropDownList("NoofRecords", new List<SelectListItem>

                                                              {
                                                               new SelectListItem{ Text="5", Value = "5" },
                                                               new SelectListItem{ Text="10", Value = "10" },
                                                               new SelectListItem{ Text="15", Value = "15" },
                                                               new SelectListItem{ Text="20", Value = "20" }, 
                                                               new SelectListItem{ Text="25", Value = "25" }, 
                                                               new SelectListItem{ Text="30", Value = "30" }, 
                                                               new SelectListItem{ Text="35", Value = "35" },
                                                               new SelectListItem{ Text="40", Value = "40" },
                                                               new SelectListItem{ Text="45", Value = "45" },
                                                               new SelectListItem{ Text="50", Value = "50" }, 
                                                              },
                                                             new { onchange = "this.form.submit()", style = "font-family:arial;font-size:13px;height:20px;width:48px;" })
                                    </li>
                                </ul>
                            </td>
                                               
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="content-box-content">
                                        <table cellspacing="0" cellpadding="0" align="center" border="0" width="100%">
                        <tr>
                            <td>
                                @{
   WebGrid Docgrid = new WebGrid(rowsPerPage: Convert.ToInt32(Model.NoofRecords), pageFieldName: "p1");}
                                            @{WebGrid grid = Docgrid.Bind(rowCount: ViewBag.totrec, source: Model.LogInfoList, autoSortAndPage: false);
                                              if (grid.TotalRowCount != 0)
                                              {
                                                  string pager = grid.Pager().ToString();
                                                  string pageno = (Request["p1"] ?? "1");
                                                  string newpager = System.Text.RegularExpressions.Regex.Replace(pager, "(\\d+) ", "<span class='selected'>" + pageno + "</span>");
                                                  string gridhtml = grid.GetHtml(tableStyle: "gridTable", headerStyle: "gridHead", rowStyle: "gridRow", alternatingRowStyle: "gridAltRow",
                                                  columns: grid.Columns(
                                                                grid.Column("Event_Title", "Event type", canSort: false, style: "name", format: @<text>
                                                                      @{
                                                                        <a id="aaudit" class="viewAuditinfo" href="#" onclick="return Displaydialog('viewAudit','@Url.Action("viewaudit", "Clients", new { logininfoid = item.EventInfoLog_ID,eventtypeid=item.Eventtype_id })','auto',1000,'dvLoading',null,null);">@item.Event_Title</a>
                                                                                                                                        }
                                                               
                                                 </text>),
                                                        grid.Column("Patientname", "Client name", canSort: false,format:@<text>
                                            @{
                                                <span>@Html.Raw(item.Patientname)</span>
                                            }
                                            </text>
                                                  ),
                                                  grid.Column("Modifiedby", "Modified by", canSort: false),
                                                  grid.Column("LoggedOn", "Logged on", canSort: false,format:@<text>
                                            @{
                                                string logon = (string)item.LoggedOn;
                                                string[] logon1 = logon.Split(' ');
                                                <span>@logon1[0].ToString()</span>
                                            }
                                            </text>
                                                  )
                                                         )).ToString();
                                                  gridhtml = System.Text.RegularExpressions.Regex.Replace(gridhtml, "<tfoot>([^<]*|<[^/]*|</[^t]*)*</tfoot>", "");
                                                @(new HtmlString(gridhtml))
                                                <br />
                                                <div class="gridFooter" style="padding-left: 500px;">@(new HtmlString(newpager))</div>  
                                                <br />



                                              }
                                              else
                                              {
                                                <table id="tblOutMsg" width="98%" horizontalalign="Center">
                                                    <tr id="troutmsg">
                                                        <td align="center" height="25px" valign="Middle">
                                                            <span id="lblOutputMsg" style="font-weight: bold;" class="errormsg">
                                                            No information log found</span>
                                                        </td>
                                                    </tr>
                                                </table>
                                              }
                                              }

                               </td>
                        </tr>
                      
                    </table>
                                        
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table> 
                                    </td>   </tr></table>
    </div>
  
    <div>
          @{Html.RenderAction("Bottomsections", "Tools");}
    </div>  
          <div id="dvLoading" style="display:none; text-align:center; vertical-align:middle">
     <img src="../Images/ajax-loader2.gif" alt="Processing"  />
    </div>
        <div id="viewAudit" title="Audit log"></div>
    }
</body>
     <script type="text/javascript">
         $(document).ready(function () {
             var TopIndex = '@Session["TopIndex"]';
             var roleid = '@Session["roleid"]';
             if (roleid == "1") {
                 $("#Menu0").removeClass();
                 $("#Menu1").removeClass();
                 $("#Menu2").removeClass();
                 $("#Menu3").addClass("active");
             }
         });
    </script>
</html>

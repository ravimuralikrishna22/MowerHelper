@model MowerHelper.Models.Classes.StateCity
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
@*    <meta name="viewport" content="width=device-width" />*@
      <title>Mower Helper-Find an Mower Helper</title>
    <script src="~/Scripts/Expire.js" type="text/javascript"></script>
      <script type="text/javascript">
          $(document).ready(function () {



              $("#ExCardNumber").bind('contextmenu', function (e) {
                  e.preventDefault();
                  //  alert('Right Click is not allowed');
              });
              // $("#ECardType").attr("MasterCard");
              var obj = "@ViewBag.practice_ind";
              //alert(obj);
              if (obj == "Y") {
                  // alert("1");
                  document.getElementById('Exchkaddress').checked = true;
              }
              else {
                  document.getElementById('Exchkaddress').checked = false;
              }
              var date = new Date();
              var Nextyear = date.getFullYear() + 1;
              $('#Exyear').val(Nextyear);

              $('#Exchkaddress').change(function () {
                  if (document.getElementById('Exchkaddress').checked == true) {
                      //                    $('#txtfirstname').val(Hdn_Fname.value);
                      // $('#txtlastname').val(Hdn_Lname.value);
                      $("#ExAddress1").attr("disabled", "disabled");
                      $("#EAddress2").attr("disabled", "disabled");
                      $("#ExZip").attr("disabled", "disabled");
                      $("#Exddlstate").attr("disabled", "disabled");
                      $("#Exddlcity").attr("disabled", "disabled");
                      $('#ExAddress1').val("@ViewBag.PAddress1");
                      $('#EAddress2').val("@ViewBag.PAddress2");
                      $('#ExZip').val("@ViewBag.PZip");
                      var Zip_code = $('#ExZip').val();
                      if (Zip_code != '') {
                          $.getJSON("GetStateCitiesByZip", { zipcode: Zip_code },
                        function (data) {
                            if (data.indexOf(",") != -1) {
                                var data1 = data.split(',');
                                $("#Exddlstate").empty();
                                $('#Exddlstate').append($('<option > </option>').val(0).html("--Select State--"));
                                $('#Exddlstate').append($('<option > </option>').val(data1[1]).html(data1[0]));
                                $("select#Exddlstate").prop('selectedIndex', 1);
                                $("#Exddlcity").empty();
                                $('#Exddlcity').append($('<option > </option>').val(0).html("--Select City--"));
                                $('#Exddlcity').append($('<option > </option>').val(data1[3]).html(data1[2]));
                                $("select#Exddlcity").prop('selectedIndex', 1);
                            }
                        }

                        );
                      }

                  }
                  else {
                      $("#ExAddress1").removeAttr("disabled");
                      $("#EAddress2").removeAttr("disabled");
                      $("#ExZip").removeAttr("disabled");
                      $("#Exddlstate").removeAttr("disabled");
                      $("#Exddlcity").removeAttr("disabled");
                      //                    $('#txtfirstname').val(null);
                      //                    $('#txtlastname').val(null);
                      $('#ExAddress1').val(null);
                      $('#EAddress2').val(null);
                      $('#ExZip').val(null);
                      $('#Exddlstate').val(0);
                      $('#Exddlcity').val(0);
                      $("#Exddlstate").empty();
                      $.getJSON("GetStateByZip",
                    function (data) {
                        $("#Exddlstate").empty();
                        $('#Exddlstate').append($('<option > </option>').val(0).html("--Select State--"));
                        for (i = 0; i < data.length; i++) {
                            if (data[i].Text != '--Select State--') {
                                $('#Exddlstate').append($('<option > </option>').val(data[i].Value).html(data[i].Text));
                            }
                        }
                    });
                      $("#Exddlcity").empty();
                      $('#Exddlcity').append($('<option > </option>').val(0).html("--Select City--"));
                      // return false;
                  }

              })


              if ($('#ExZip').val() != '') {
                  var recordId = $('#ExZip').val();
                  var stateid = "@ViewBag.State_ID";
                  var statename = "@ViewBag.Statename";
                  var City_ID = "@ViewBag.City_ID";
                  var Cityname = "@ViewBag.Cityname";
                  //                             alert(stateid);
                  //                             alert(statename);
                  //                             alert(City_ID);
                  //                             alert(City);
                  if (recordId != '' && stateid != '' && City_ID != '') {
                      $("#Exddlstate").empty();
                      $('#Exddlstate').append($('<option > </option>').val(0).html("--Select State--"));
                      $('#Exddlstate').append($('<option > </option>').val(stateid).html(statename));
                      $("select#Exddlstate").prop('selectedIndex', 1);
                      $("#Exddlcity").empty();
                      $('#Exddlcity').append($('<option > </option>').val(0).html("--Select City--"));
                      $('#Exddlcity').append($('<option > </option>').val(City_ID).html(Cityname));
                      $("select#Exddlcity").prop('selectedIndex', 1);
                  }
              }

              $('#Exddlstate').change(function () {
                  var recordId = $('#Exddlstate').val();
                  var recordId1 = $("#ExZip").val();
                  if (recordId != '' && recordId1 == '') {
                      // alert('a');
                      $.getJSON("GetCitiesByStates", { id: recordId },
                    function (data) {
                        $("#Exddlcity").empty();
                        $('#Exddlcity').append($('<option > </option>').val(0).html("--Select City--"));
                        for (i = 0; i < data.length; i++) {
                            if (data[i].Text != '--Select City--') {
                                $('#Exddlcity').append($('<option > </option>').val(data[i].Value).html(data[i].Text));
                            }
                        }
                    });
                      // return false;
                  }
                  else if (recordId != '' && recordId1 != '') {
                      //alert('b');
                      $.getJSON("GetCitiesByZip", { id: recordId, zipcode: recordId1 },
                    function (data) {
                        $("#Exddlcity").empty();
                        $('#Exddlcity').append($('<option > </option>').val(0).html("--Select City--"));
                        for (i = 0; i < data.length; i++) {
                            if (data[i].Text != '--Select City--') {
                                $('#Exddlcity').append($('<option > </option>').val(data[i].Value).html(data[i].Text));
                            }
                        }
                    });
                      // return false;
                  }
                  else {
                      // alert('c');
                      $("#Exddlcity").empty();
                      $('#Exddlcity').append($('<option > </option>').val(0).html("--Select City--"));
                      // return false;
                  }
              });
              $('#ExZip').change(function () {
                  var recordId = $('#ExZip').val();
                  if (recordId != '') {
                      $.getJSON("GetStateCitiesByZip", { zipcode: recordId },
                    function (data) {
                        if (data.indexOf(",") != -1) {
                            var data1 = data.split(',');
                            $("#Exddlstate").empty();
                            $('#Exddlstate').append($('<option > </option>').val(0).html("--Select State--"));
                            $('#Exddlstate').append($('<option > </option>').val(data1[1]).html(data1[0]));
                            $("select#Exddlstate").prop('selectedIndex', 1);
                            $("#Exddlcity").empty();
                            $('#Exddlcity').append($('<option > </option>').val(0).html("--Select City--"));
                            $('#Exddlcity').append($('<option > </option>').val(data1[3]).html(data1[2]));
                            $("select#Exddlcity").prop('selectedIndex', 1);
                        }
                        else {
                            $("#Exddlstate").empty();
                            $('#Exddlstate').append($('<option > </option>').val(0).html("--Select State--"));
                            for (i = 0; i < data.length; i++) {
                                if (data[i].Text != '--Select State--') {
                                    $('#Exddlstate').append($('<option > </option>').val(data[i].Value).html(data[i].Text));
                                }
                            }
                            $("#Exddlcity").empty();
                            $('#Exddlcity').append($('<option > </option>').val(0).html("--Select City--"));
                        }
                    });
                      // return false;
                  }
                  else {
                      $.getJSON("GetStateByZip",
                    function (data) {
                        $("#Exddlstate").empty();
                        $('#Exddlstate').append($('<option > </option>').val(0).html("--Select State--"));
                        for (i = 0; i < data.length; i++) {
                            if (data[i].Text != '--Select State--') {
                                $('#Exddlstate').append($('<option > </option>').val(data[i].Value).html(data[i].Text));
                            }
                        }
                    });
                      $("#Exddlcity").empty();
                      $('#Exddlcity').append($('<option > </option>').val(0).html("--Select City--"));
                      // return false;
                  }
              });
          });
          function exclick() {
              document.getElementById('extrmsgdiv').style.display = 'none';
              document.getElementById('extrdiv').style.display = '';
            
          }
    </script>
    <script type="text/javascript">
        $(function () {
            $("#ExZip").keyup(function () {
                if ($(this).val().length == 5) {
                    $("#Exddlstate").focus();
                }
            });

        });
    </script>
    <script type="text/javascript">
        var Cards = new makeArray(8);
        Cards[0] = new CardType("MasterCard", "51,52,53,54,55", "16");
        var MasterCard = Cards[0];
        Cards[1] = new CardType("VisaCard", "4", "13,16");
        var VisaCard = Cards[1];
        Cards[2] = new CardType("AmExCard", "34,37", "15");
        var AmExCard = Cards[2];
        Cards[3] = new CardType("DinersClubCard", "30,36,38", "14");
        var DinersClubCard = Cards[3];
        Cards[4] = new CardType("DiscoverCard", "6011", "16");
        var DiscoverCard = Cards[4];
        Cards[5] = new CardType("enRouteCard", "2014,2149", "15");
        var enRouteCard = Cards[5];
        Cards[6] = new CardType("JCBCard", "3088,3096,3112,3158,3337,3528,3530,3566", "16");
        var JCBCard = Cards[6];
        var LuhnCheckSum = Cards[7] = new CardType();

        /*************************************************************************\
        CheckCardNumber(form)
        function called when users click the "check" button.
        \*************************************************************************/
        function CheckCardNumber() {
            var tmpyear;

            if (document.getElementById('ExCardNumber1').value.length == 0) {
                Glb_ShowAlert("Please enter a Card Number.");
                document.getElementById('ExCardNumber').focus();
                return false;
            }
            if (document.getElementById('ExCardNumber1').value.length > 0) {
                var ccnum = document.getElementById('ExCardNumber1').value;
                var sum = 0;
                var mods = ccnum.length % 2;
                var i = 0;
                while (i < ccnum.length) {
                    var digit = parseInt(ccnum.charAt(i));
                    if (i % 2 == mods)
                        digit = digit * 2;
                    if (digit > 9) {
                        digit = digit - 9;
                    }
                    sum += digit;
                    i += 1;
                }
                if ((sum % 10) != 0) {
                    //                    Glb_ShowAlert("This is not a valid credit card number.");
                    document.getElementById('Exlblcardnumber').style.display = '';
                    document.getElementById('Exlblcardnumber').innerHTML = 'This is not a valid credit card number.';
                    document.getElementById('ExCardNumber').focus();
                    document.getElementById('ExTableCell25').bgColor = "orange";
                    return false;
                }
            }

            /*if (form.ExpYear.value.length == 0) {
            Glb_ShowAlert("Please enter the Expiration Year.");
            form.ExpYear.focus();
            return;
            }

            if (form.ExpYear.value > 96)
            tmpyear = "19" + form.ExpYear.value;
            else if (form.ExpYear.value < 21)
            tmpyear = "20" + form.ExpYear.value;
            else {
            Glb_ShowAlert("The Expiration Year is not valid.");
            return;
            }*/
            tmpyear = document.getElementById('Exyear').options[document.getElementById('Exyear').selectedIndex].value;
            tmpmonth = document.getElementById('Exmonth').options[document.getElementById('Exmonth').selectedIndex].value;
            card = document.getElementById('ExCardType').options[document.getElementById('ExCardType').selectedIndex].text;
            if (card == "American Express") {
                card = "AmExCard";
            }
            var retval = eval(card + ".checkCardNumber(\"" + document.getElementById('ExCardNumber1').value +
"\", " + tmpyear + ", " + tmpmonth + ");");
            cardname = "";
            //            alert(retval);
            if (retval)

                // comment this out if used on an order form
                //Glb_ShowAlert("This card number appears to be valid.");
                return true;

            else {
                // The cardnumber has the valid luhn checksum, but we want to know which
                // cardtype it belongs to.
                for (var n = 0; n < Cards.size; n++) {
                    //                    alert("1");
                    //                    alert(form.CardNumber1.value);
                    //                    alert(tmpyear);
                    //                    alert(tmpmonth);
                    //                    alert(Cards[0]);
                    if (Cards[n].checkCardNumber(document.getElementById('ExCardNumber1').value, tmpyear, tmpmonth)) {
                        // alert("1.1");
                        cardname = Cards[n].getCardType();
                        //  alert(cardname);
                        break;
                    }
                }
                //  alert(cardname.length);
                //                alert(cardname);
                if (cardname.length > 0) {
                    //                    alert(cardname.length);
                    //                    alert("well");
                    //Glb_ShowAlert("This is  " + cardname + " number,not  " + card + " number.");
                    //                    Glb_ShowAlert("Please verify the card type.");
                    //                    alert("Please verify the card type.");
                    //                    return false;
                    document.getElementById('Exlbcardtype').style.display = '';
                    //                    alert("1");
                    document.getElementById('Exlbcardtype').innerHTML = 'Please verify the card type.';
                    //                    alert("2");
                    document.getElementById('ExTableCell29').bgColor = "orange";
                    //                    alert("3");
                    document.getElementById('ExCardType').focus();
                    //                    alert("4");
                    return false;
                }
                else {
                    //                    alert('76');
                    document.getElementById('Exlbcardtype').style.display = 'none';
                    //                    document.getElementById('lbcardtype').innerHTML = 'Please verify the card type.';
                    document.getElementById('ExTableCell29').bgColor = "white";
                    Glb_ShowAlert("This card number is not valid.");
                    document.getElementById('ExCardNumber').focus();
                    return false;
                }
            }

            // The following line doesn't work in IE3, you need to change it
            // to something like "(new CardType())...".
            // if (!CardType().isExpiryDate(tmpyear, tmpmonth)) {

        }

        /*************************************************************************\
        Object CardType([String cardtype, String rules, String len, int year, 
        int month])
        cardtype    : type of card, eg: MasterCard, Visa, etc.
        rules       : rules of the cardnumber, eg: "4", "6011", "34,37".
        len         : valid length of cardnumber, eg: "16,19", "13,16".
        year        : year of expiry date.
        month       : month of expiry date.
        eg:
        var VisaCard = new CardType("Visa", "4", "16");
        var AmExCard = new CardType("AmEx", "34,37", "15");
        \*************************************************************************/
        function CardType() {
            var n;
            var argv = CardType.arguments;
            var argc = CardType.arguments.length;

            this.objname = "object CardType";

            var tmpcardtype = (argc > 0) ? argv[0] : "invalid card";
            var tmprules = (argc > 1) ? argv[1] : "0,1,2,3,4,5,6,7,8,9";
            var tmplen = (argc > 2) ? argv[2] : "13,14,15,16,19";

            this.setCardNumber = setCardNumber;  // set CardNumber method.
            this.setCardType = setCardType;  // setCardType method.
            this.setLen = setLen;  // setLen method.
            this.setRules = setRules;  // setRules method.
            this.setExpiryDate = setExpiryDate;  // setExpiryDate method.

            this.setCardType(tmpcardtype);
            this.setLen(tmplen);
            this.setRules(tmprules);
            if (argc > 4)
                this.setExpiryDate(argv[3], argv[4]);

            this.checkCardNumber = checkCardNumber;  // checkCardNumber method.
            this.getExpiryDate = getExpiryDate;  // getExpiryDate method.
            this.getCardType = getCardType;  // getCardType method.
            this.isCardNumber = isCardNumber;  // isCardNumber method.
            this.isExpiryDate = isExpiryDate;  // isExpiryDate method.
            this.luhnCheck = luhnCheck; // luhnCheck method.
            return this;
        }

        /*************************************************************************\
        boolean checkCardNumber([String cardnumber, int year, int month])
        return true if cardnumber pass the luhncheck and the expiry date is
        valid, else return false.
        \*************************************************************************/
        function checkCardNumber() {
            // alert('5');
            var argv = checkCardNumber.arguments;
            var argc = checkCardNumber.arguments.length;
            var cardnumber = (argc > 0) ? argv[0] : this.cardnumber;
            var year = (argc > 1) ? argv[1] : this.year;
            var month = (argc > 2) ? argv[2] : this.month;
            //  alert(cardnumber);
            this.setCardNumber(cardnumber);
            this.setExpiryDate(year, month);

            if (!this.isCardNumber())
                return false;
            //            if (!this.isExpiryDate())
            //                return false;
            return true;
        }
        /*************************************************************************\
        String getCardType()
        return the cardtype.
        \*************************************************************************/
        function getCardType() {
            return this.cardtype;
        }
        /*************************************************************************\
        String getExpiryDate()
        return the expiry date.
        \*************************************************************************/
        function getExpiryDate() {
            return this.month + "/" + this.year;
        }
        /*************************************************************************\
        boolean isCardNumber([String cardnumber])
        return true if cardnumber pass the luhncheck and the rules, else return
        false.
        \*************************************************************************/
        function isCardNumber() {
            var argv = isCardNumber.arguments;
            var argc = isCardNumber.arguments.length;
            // alert(argv);
            // alert(argc);
            var cardnumber = (argc > 0) ? argv[0] : this.cardnumber;
            //  alert(cardnumber);
            if (!this.luhnCheck())
                return false;

            for (var n = 0; n < this.len.size; n++)
                if (cardnumber.toString().length == this.len[n]) {
                    for (var m = 0; m < this.rules.size; m++) {
                        var headdigit = cardnumber.substring(0, this.rules[m].toString().length);
                        if (headdigit == this.rules[m])
                            return true;
                    }
                    return false;
                }
            // return false;
        }

        /*************************************************************************\
        boolean isExpiryDate([int year, int month])
        return true if the date is a valid expiry date,
        else return false.
        \*************************************************************************/
        function isExpiryDate() {
            var argv = isExpiryDate.arguments;
            var argc = isExpiryDate.arguments.length;

            year = argc > 0 ? argv[0] : this.year;
            month = argc > 1 ? argv[1] : this.month;

            if (!isNum(year + ""))
                return false;
            if (!isNum(month + ""))
                return false;
            today = new Date();
            expiry = new Date(year, month);
            if (today.getTime() > expiry.getTime())
                return false;
            else
                return true;
        }

        /*************************************************************************\
        boolean isNum(String argvalue)
        return true if argvalue contains only numeric characters,
        else return false.
        \*************************************************************************/
        function isNum(argvalue) {
            argvalue = argvalue.toString();

            if (argvalue.length == 0)
                return false;

            for (var n = 0; n < argvalue.length; n++)
                if (argvalue.substring(n, n + 1) < "0" || argvalue.substring(n, n + 1) > "9")
                    return false;

            return true;
        }

        /*************************************************************************\
        boolean luhnCheck([String CardNumber])
        return true if CardNumber pass the luhn check else return false.
        Reference: http://www.ling.nwu.edu/~sburke/pub/luhn_lib.pl
        \*************************************************************************/
        function luhnCheck() {
            var argv = luhnCheck.arguments;
            var argc = luhnCheck.arguments.length;

            var CardNumber = argc > 0 ? argv[0] : this.cardnumber;

            if (!isNum(CardNumber)) {
                return false;
            }

            var no_digit = CardNumber.length;
            var oddoeven = no_digit & 1;
            var sum = 0;

            for (var count = 0; count < no_digit; count++) {
                var digit = parseInt(CardNumber.charAt(count));
                if (!((count & 1) ^ oddoeven)) {
                    digit *= 2;
                    if (digit > 9)
                        digit -= 9;
                }
                sum += digit;
            }
            if (sum % 10 == 0) {
                // alert("true");
                return true;
            }
            else {
                //alert("false");
                return false;
            }
        }

        /*************************************************************************\
        ArrayObject makeArray(int size)
        return the array object in the size specified.
        \*************************************************************************/
        function makeArray(size) {
            this.size = size;
            return this;
        }

        /*************************************************************************\
        CardType setCardNumber(cardnumber)
        return the CardType object.
        \*************************************************************************/
        function setCardNumber(cardnumber) {
            this.cardnumber = cardnumber;
            return this;
        }

        /*************************************************************************\
        CardType setCardType(cardtype)
        return the CardType object.
        \*************************************************************************/
        function setCardType(cardtype) {
            this.cardtype = cardtype;
            return this;
        }

        /*************************************************************************\
        CardType setExpiryDate(year, month)
        return the CardType object.
        \*************************************************************************/
        function setExpiryDate(year, month) {
            this.year = year;
            this.month = month;
            return this;
        }

        /*************************************************************************\
        CardType setLen(len)
        return the CardType object.
        \*************************************************************************/
        function setLen(len) {
            // Create the len array.
            if (len.length == 0 || len == null)
                len = "13,14,15,16,19";

            var tmplen = len;
            n = 1;
            while (tmplen.indexOf(",") != -1) {
                tmplen = tmplen.substring(tmplen.indexOf(",") + 1, tmplen.length);
                n++;
            }
            this.len = new makeArray(n);
            n = 0;
            while (len.indexOf(",") != -1) {
                var tmpstr = len.substring(0, len.indexOf(","));
                this.len[n] = tmpstr;
                len = len.substring(len.indexOf(",") + 1, len.length);
                n++;
            }
            this.len[n] = len;
            return this;
        }

        /*************************************************************************\
        CardType setRules()
        return the CardType object.
        \*************************************************************************/
        function setRules(rules) {
            // Create the rules array.
            if (rules.length == 0 || rules == null)
                rules = "0,1,2,3,4,5,6,7,8,9";

            var tmprules = rules;
            n = 1;
            while (tmprules.indexOf(",") != -1) {
                tmprules = tmprules.substring(tmprules.indexOf(",") + 1, tmprules.length);
                n++;
            }
            this.rules = new makeArray(n);
            n = 0;
            while (rules.indexOf(",") != -1) {
                var tmpstr = rules.substring(0, rules.indexOf(","));
                this.rules[n] = tmpstr;
                rules = rules.substring(rules.indexOf(",") + 1, rules.length);
                n++;
            }
            this.rules[n] = rules;
            return this;
        }
        function clearalerts() {
            document.getElementById('Exlbcardtype').style.display = 'none';
            document.getElementById('ExTableCell29').bgColor = "white";
            document.getElementById('ExTableCell25').bgColor = "White";
            document.getElementById('Exlblcardnumber').style.display = 'none';
            document.getElementById('ExTd2').bgColor = "white";
            document.getElementById('Exlblfirstname').style.display = 'none';
            document.getElementById('ExTd4').bgColor = "White";
            document.getElementById('Exlbllastname').style.display = 'none';
            document.getElementById('ExTableCell31').bgColor = "white";
            document.getElementById('ExlblExpyear').style.display = 'none';
            document.getElementById('ExTableCell35').bgColor = "white";
            document.getElementById('Exlbladdress').style.display = 'none';
            document.getElementById('Extdzip').bgColor = "white";
            document.getElementById('Exlblzip').style.display = 'none';
            document.getElementById('Extdstate').bgColor = "White";
            document.getElementById('Exlblstate').style.display = 'none';
            document.getElementById('Extdcity').bgColor = "white";
            document.getElementById('Exlblcity').style.display = 'none';

        }
        function ExCognodeProcess() {
            var my_str = document.getElementById('ExCardNumber').value;
            var str = "*";
            if (my_str.indexOf(str) == -1) {
                clearalerts()
                document.getElementById('ExCardNumber1').value = document.getElementById('ExCardNumber').value;
            }
            else {

                if (document.getElementById('ExCardNumber1').value == '') {

                    clearalerts()
                    document.getElementById('ExCardNumber1').value = document.getElementById('ExCardNumber').value;
                }
                else if (document.getElementById('ExCardNumber1').value != '' && document.getElementById('ExCardNumber').value != '') {
                    clearalerts()
                    if (document.getElementById('Ehdncardnumber').value != document.getElementById('ExCardNumber').value) {
                        clearalerts()
                        //				                Glb_ShowAlert("Please enter valid Credit Card Number");
                        document.getElementById('Exlblcardnumber').style.display = '';
                        document.getElementById('Exlblcardnumber').innerHTML = 'Please enter valid Credit Card Number';
                        document.getElementById('ExTableCell25').bgColor = "orange";
                        document.getElementById('ExCardNumber').focus();
                        return false;
                    }
                    else {
                        document.getElementById('ExTableCell25').bgColor = "White";
                        document.getElementById('Exlblcardnumber').style.display = 'none';
                    }
                }
            }
            if (document.getElementById('ExCardNumber').value == '') {
                clearalerts()
                //                 alert('5')
                //Glb_ShowAlert("Please enter credit card number");
                //					    document.frmCreditCard.lblcardnumber.style.display = '';
                document.getElementById('Exlblcardnumber').style.display = '';
                document.getElementById('Exlblcardnumber').innerHTML = 'Please enter credit card number';
                document.getElementById('ExTableCell25').bgColor = "orange";
                document.getElementById('ExCardNumber').focus();
                return false;
            }
            else {
                document.getElementById('ExTableCell25').bgColor = "White";
                document.getElementById('Exlblcardnumber').style.display = 'none';
            }
            var StrCardValue;
            StrCardValue = document.getElementById('ExCardNumber').value;

            if (StrCardValue.length < 13) {
                clearalerts()
                document.getElementById('Exlblcardnumber').style.display = '';
                //                Glb_ShowAlert("Please enter 13 Digit Card Number");
                document.getElementById('Exlblcardnumber').innerHTML = 'Please enter 13 Digit Card Number';
                document.getElementById('ExTableCell25').bgColor = "orange";
                document.getElementById('ExCardNumber').focus();
                return false;
            }
            else {
                document.getElementById('ExTableCell25').bgColor = "White";
                document.getElementById('Exlblcardnumber').style.display = 'none';
            }

            if (CheckCardNumber() == true) {
                var strfirstname = trim(document.getElementById('Extxtfirstname').value);
                document.getElementById('Extxtfirstname').value = strfirstname;
                if (MyChars(document.getElementById('Extxtfirstname')) == 'BlankError') {
                    clearalerts()
                    //						    Glb_ShowAlert("Please enter first name");
                    document.getElementById('Exlbcardtype').style.display = 'none';
                    //                    document.getElementById('lbcardtype').innerHTML = 'Please verify the card type.';
                    document.getElementById('ExTableCell29').bgColor = "white";
                    document.getElementById('Exlblfirstname').style.display = '';
                    document.getElementById('Exlblfirstname').innerHTML = 'Please enter first name';
                    document.getElementById('ExTd2').bgColor = "orange";
                    document.getElementById('Extxtfirstname').focus();
                    return false;
                }
                else {
                    document.getElementById('ExTd2').bgColor = "white";
                    document.getElementById('Exlblfirstname').style.display = 'none';
                }

                if (MyChars(document.getElementById('Extxtfirstname')) == "NumError") {
                    clearalerts()
                    //						    Glb_ShowAlert("Please enter first name in alphabets");
                    document.getElementById('Exlbcardtype').style.display = 'none';
                    //                    document.getElementById('lbcardtype').innerHTML = 'Please verify the card type.';
                    document.getElementById('ExTableCell29').bgColor = "white";
                    document.getElementById('Exlblfirstname').style.display = '';
                    document.getElementById('Exlblfirstname').innerHTML = 'Please enter first name in alphabets';
                    document.getElementById('ExTd2').bgColor = "orange";
                    document.getElementById('Extxtfirstname').focus();
                    return false;
                }
                else {
                    document.getElementById('ExTd2').bgColor = "white";
                    document.getElementById('Exlblfirstname').style.display = 'none';
                }


                var strlastname = trim(document.getElementById('Extxtlastname').value);
                document.getElementById('Extxtlastname').value = strlastname;
                if (MyChars(document.getElementById('Extxtlastname')) == 'BlankError') {
                    clearalerts()
                    //						    Glb_ShowAlert("Please enter Last Name");
                    document.getElementById('Exlbcardtype').style.display = 'none';
                    //                    document.getElementById('lbcardtype').innerHTML = 'Please verify the card type.';
                    document.getElementById('ExTableCell29').bgColor = "white";
                    document.getElementById('Exlbllastname').style.display = '';
                    document.getElementById('Exlbllastname').innerHTML = 'Please enter Last Name';
                    document.getElementById('ExTd4').bgColor = "orange";
                    document.getElementById('Extxtlastname').focus();
                    return false;
                }
                else {
                    document.getElementById('ExTd4').bgColor = "White";
                    document.getElementById('Exlbllastname').style.display = 'none';

                }

                if (MyChars(document.getElementById('Extxtlastname')) == "NumError") {
                    clearalerts()
                    //						    Glb_ShowAlert("Please enter last name in alphabets");
                    document.getElementById('Exlbcardtype').style.display = 'none';
                    //                    document.getElementById('lbcardtype').innerHTML = 'Please verify the card type.';
                    document.getElementById('ExTableCell29').bgColor = "white";
                    document.getElementById('Exlbllastname').style.display = '';
                    document.getElementById('Exlbllastname').innerHTML = 'Please enter last name in alphabets';
                    document.getElementById('ExTd4').bgColor = "orange";
                    document.getElementById('Extxtlastname').focus();
                    return false;
                }
                else {
                    document.getElementById('ExTd4').bgColor = "White";
                    document.getElementById('Exlbllastname').style.display = 'none';
                }
                var tmpyear = document.getElementById('Exyear').value;
                var tmpmonth = document.getElementById('Exmonth').value;
                //            alert(tmpyear);
                //            alert(tmpmonth);

                var today = new Date();
                var expiry = new Date(tmpyear, tmpmonth);
                //            alert(today);
                //            alert(expiry);
                if (today.getTime() > expiry.getTime()) {
                    clearalerts();
                    document.getElementById('Exlbcardtype').style.display = 'none';
                    document.getElementById('ExTableCell29').bgColor = "white";
                    document.getElementById('ExlblExpyear').style.display = '';
                    document.getElementById('ExlblExpyear').innerHTML = 'This card has already expired';
                    document.getElementById('ExTableCell31').bgColor = "orange";
                    return false;
                }
                else {
                    document.getElementById('ExTableCell31').bgColor = "white";
                    document.getElementById('ExlblExpyear').style.display = 'none';
                }


                var str_BAddress1;
                str_BAddress1 = trim(document.getElementById('ExAddress1').value);
                document.getElementById('ExAddress1').value = str_BAddress1;
                if (str_BAddress1 == '') {
                    clearalerts()
                    //                    Glb_ShowAlert("Please enter billing address");
                    document.getElementById('Exlbladdress').style.display = '';
                    document.getElementById('Exlbladdress').innerHTML = 'Please enter billing address';
                    document.getElementById('ExTableCell35').bgColor = "orange";
                    document.getElementById('ExAddress1').focus();
                    return false;
                }
                else {
                    document.getElementById('ExTableCell35').bgColor = "white";
                    document.getElementById('Exlbladdress').style.display = 'none';
                }
                if (document.getElementById('ExZip').value == '') {
                    clearalerts()
                    //						Glb_ShowAlert("Please enter zip");
                    document.getElementById('Exlblzip').style.display = '';
                    document.getElementById('Exlblzip').innerHTML = 'Please enter zip';
                    document.getElementById('Extdzip').bgColor = "orange";
                    document.getElementById('ExZip').focus();
                    return false;
                }
                else {
                    document.getElementById('Extdzip').bgColor = "white";
                    document.getElementById('Exlblzip').style.display = 'none';
                }

                if (document.getElementById('ExZip').value.length != 5) {
                    clearalerts()
                    //						Glb_ShowAlert("Please enter valid zip");
                    document.getElementById('Exlblzip').style.display = '';
                    document.getElementById('Exlblzip').innerHTML = 'Please enter valid zip';
                    document.getElementById('Extdzip').bgColor = "orange";
                    document.getElementById('ExZip').focus();
                    return false;
                }
                else {
                    document.getElementById('Extdzip').bgColor = "white";
                    document.getElementById('Exlblzip').style.display = 'none';
                }
                if (document.getElementById('Exddlstate').selectedIndex == 0) {
                    clearalerts()
                    //						Glb_ShowAlert("Please select state");
                    document.getElementById('Exlblstate').style.display = '';
                    document.getElementById('Exlblstate').innerHTML = 'Please select state';
                    document.getElementById('Extdstate').bgColor = "orange";
                    document.getElementById('Exddlstate').focus();
                    return false;
                }
                else {
                    document.getElementById('Extdstate').bgColor = "White";
                    document.getElementById('Exlblstate').style.display = 'none';
                }

                if (document.getElementById('Exddlcity').selectedIndex == 0) {
                    clearalerts()
                    //					    Glb_ShowAlert("Please select city");
                    document.getElementById('Exlblcity').style.display = '';
                    document.getElementById('Exlblcity').innerHTML = 'Please select city';
                    document.getElementById('Extdcity').bgColor = "orange"
                    document.getElementById('Exddlcity').focus();
                    return false;
                }
                else {
                    document.getElementById('Extdcity').bgColor = "white";
                    document.getElementById('Exlblcity').style.display = 'none';
                }
            }
            else {
                return false;
            }

            document.getElementById('Exhdnadd1').value = document.getElementById('ExAddress1').value;
            document.getElementById('Exhdnadd2').value = document.getElementById('EAddress2').value;
            document.getElementById('Exhdnzip').value = document.getElementById('ExZip').value;
            document.getElementById('Exhdnstate').value = document.getElementById('Exddlstate').value;
            document.getElementById('Exhdncity').value = document.getElementById('Exddlcity').value;
            document.body.style.cursor = 'wait';
            document.getElementById("Exupdate-message").style.display = 'none';
             document.getElementById("Exdiv10").style.display = 'none';
            document.getElementById("ExupdNote").style.display = '';
            //$('#ExupdNote').dialog({ modal: true, dialogClass: 'dvLoading', draggable: false, resizable: false });
            //                  }       
            //            document.getElementById("tblProcess").style.display = 'none';
            //            $("#updateDialog").dialog({
            //                modal: true,
            //                width: 500,
            //                resizable: false,
            //                closeOnEscape: false,
            //                open: function (event, ui) { $(".ui-dialog-titlebar").hide(); }

            //            });

        }

    </script>
</head>
<body>
    @using (Ajax.BeginForm("ExpiryPaymentMethod", "Tolls", new AjaxOptions
        {
            InsertionMode = InsertionMode.Replace,
            HttpMethod = "POST",
            OnSuccess = "ExInfoSuccessex"

        }, new { @id = "updateCarForm1" }))
    {
        @Html.AntiForgeryToken()
        <input type="hidden" id="ExCardNumber1" name="ExCardNumber1" />
        <input id="Ehdncardnumber" type="hidden" name="Ehdncardnumber" /> 
        <input type="hidden" id="ExHdnPractice_ID" name="ExHdnPractice_ID" value="@ViewBag.Practice_ID" />
        <input type="hidden" id="ExHdnProvider_ID" name="ExHdnProvider_ID" value="@ViewBag.Provider_ID" />
          <input type="hidden" id="ExhdnCardid" name="ExhdnCardid" value="@ViewBag.CardID" />
        <input type="hidden" id="Exhdnadd1" name="Exhdnadd1" value="" />
        <input type="hidden" id="Exhdnadd2" name="Exhdnadd2" value="" />
        <input type="hidden" id="Exhdnzip" name="Exhdnzip" value="" />
        <input type="hidden" id="Exhdnstate" name="Exhdnstate" value="" />
        <input type="hidden" id="Exhdncity" name="Exhdncity" value="" />
     
        <table style="width:100%;">
            <tr id="extrdiv" style="width:100%; display:none;" > <td style="width:100%;">
                   <div id="Exupdate-message" class="error" style="padding-left: 250px; font-weight: bold;">
        </div>
                <div id="Exdiv10" class="content-box">
        <div class="clear"></div>
            <div class="content-box-content">
                <table align="center" width="100%" cellpadding="6" cellspacing="1" border="0" class="border_style">
                    <tr class="white_color" id="Erow12">
                        <td align="right" style="width: 30%" id="ETableCell28" runat="server">
                            <font color="red">*</font><strong>Card type :&nbsp;</strong>
                        </td>
                        <td id="ExTableCell29" runat="server">
                            @Html.DropDownList("ExCardType", null, new { @class = "textfield", @style = "height:25px" })
                            &nbsp;&nbsp;&nbsp;<span id="Exlbcardtype" style="display: none"></span>
                        </td>
                    </tr>
                    <tr id="Erow10" class="nav_blue_color">
                        <td id="ETableCell24" align="right" style="width: 30%">
                            <font color="red">*</font><strong>Credit card number :&nbsp;</strong>
                        </td>
                        <td id="ExTableCell25" runat="server">
                            @Html.TextBox("ExCardNumber", (string)ViewBag.cardnumber, new { @class = "textfield", @onkeydown = "return isValidNumeric(ExCardNumber,16,0,event);", autocomplete = "off" })
                            <b>Cvv :&nbsp;</b>
                            @Html.TextBox("ExtxtCVV2", (string)ViewBag.cvv2, new
                       {
                           @style = "width:50px",
                           @class = "textfield",
                           @onkeypress = "return AlphaNumbers(event);"
                       })
                            <img src="~/Images/help2.png" id="Img2" style="vertical-align: middle" />
                            <div id="divCvv" style="display: none">
                                <table id="Table7" width="100%" runat="server">
                                    <tr>
                                        <td>
                                            <img src="~/Images/cvv2.jpg" />
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="Exlblcardnumber" style="display: none"></span>
                        </td>
                    </tr>
                    <tr id="Etrfirstname" class="white_color">
                        <td id="ETd1" align="Right" style="width: 30%">
                            <font color="red">*</font><strong>First name :</strong>&nbsp;
                        </td>
                        <td id="ExTd2" runat="server">
                            @Html.TextBox("Extxtfirstname", (string)ViewBag.FirstName, new { @class = "textfield", autocomplete = "off" })&nbsp;&nbsp;&nbsp;&nbsp;<span
                                id="Exlblfirstname" style="display: none"></span>
                        </td>
                    </tr>
                    <tr id="Etrlastname" class="nav_blue_color">
                        <td id="ETd3" align="Right" style="width: 30%">
                            <font color="red">*</font><strong>Last name :</strong>&nbsp;
                        </td>
                        <td id="ExTd4" runat="server">
                            @Html.TextBox("Extxtlastname", (string)ViewBag.LastName, new { @class = "textfield", autocomplete = "off" })&nbsp;&nbsp;&nbsp;&nbsp;<span
                                id="Exlbllastname" style="display: none"></span>
                        </td>
                    </tr>
                    <tr id="Erow13" class="white_color">
                        <td id="ETableCell30" align="right" style="width: 30%">
                            <font color="red">*</font><strong>Card expiry date :&nbsp;</strong>
                        </td>
                        <td id="ExTableCell31" runat="server">
                            @Html.DropDownList("Exmonth", null, new { @class = "textfield", @style = "width:50px" })
                            @Html.DropDownList("Exyear", null, new { @class = "textfield", @style = "width:100px" })
                            &nbsp;&nbsp;&nbsp;&nbsp;<span id="ExlblExpyear" style="display: none;"></span>
                        </td>
                    </tr>
                    <tr id="row14" runat="server" class="nav_blue_color">
                                    <td id="TableCell32" runat="server" align="right" style="width: 30%">

                                        <strong>Amount :&nbsp;</strong>
                                    </td>
                                    <td id="TableCell33" runat="server">
                                    @Html.Hidden("Exhdmamount", "1")
                                    @* @Html.TextBox("amt", "$1.00", new { @style = "width:50px;", disabled = "true" })*@
                                   <span id="spanamt">$1.00</span>
                                   @if (ViewBag.regFee != null)
                                   {
                                   <img src="~/Images/help2.png" id="Img3" onmouseover="ddrivetip('@ViewBag.regFee',300)" onmouseout="hideddrivetip()" style="vertical-align:middle" />
                                   }
                                    </td>
                                </tr>
                    <tr class="white_color" id="Erow15">
                        <td id="ETableCell34" align="right" style="width: 30%">
                            <font color="red">*</font><strong>Billing address 1 :&nbsp;</strong>
                        </td>
                        <td id="ExTableCell35" runat="server">
                            @Html.TextBox("ExAddress1", (string)ViewBag.Address1, new { @class = "textfield", autocomplete = "off", style = "width:300px", disabled = "disabled" })&nbsp;&nbsp;&nbsp;<span
                                id="Exlbladdress" style="display: none"></span>
                            @Html.CheckBox("Exchkaddress")&nbsp;&nbsp;&nbsp; <strong>Same as mower helper address
                            </strong>
                            
                        </td>
                    </tr>
                    <tr id="Erow16" class="nav_blue_color">
                        <td id="ETableCell36" align="right" style="width: 30%">
                            <strong>Address 2 :&nbsp;</strong>
                        </td>
                        <td id="ETableCell37" runat="server">
                            @Html.TextBox("EAddress2", (string)ViewBag.Address2, new { @class = "textfield", autocomplete = "off", style = "width:300px", disabled = "disabled" })
                        </td>
                    </tr>
                    <tr class="white_color">
                        <td align="right" style="width: 30%">
                            <font color="red"><b>*</b></font><strong>Zip :&nbsp;</strong>
                        </td>
                        <td id="Extdzip">
                            @Html.TextBox("ExZip", (string)ViewBag.Zip, new { @class = "textfield", autocomplete = "off", style = "width:50px", onkeypress = "return ValidZip(event);", disabled = "disabled" })&nbsp;&nbsp;&nbsp;<span
                                id="Exlblzip" style="display: none"></span>
                        </td>
                    </tr>
                    <tr class="nav_blue_color">
                        <td align="right" style="width: 30%">
                            <font color="red"><b>*</b></font><strong>State :&nbsp;</strong>
                        </td>
                        <td id="Extdstate" runat="server">
                            @* @Html.DropDownList("state")*@
                            @if (Model.StateList != null)
                            {
                                @Html.DropDownList("Exddlstate", Model.StateList, "--Select State--", new { @class = "textfield", @style = "width:270px;height:25px;font:13px;", disabled = "disabled" })
                            }
                            &nbsp;&nbsp;&nbsp;<span id="Exlblstate" style="display: none"></span>
                        </td>
                    </tr>
                    <tr class="white_color">
                        <td align="right" style="width: 30%">
                            &nbsp;<font color="red"><b>*</b></font><strong>City :&nbsp;</strong>
                        </td>
                        <td id="Extdcity" runat="server">
                            @* @Html.DropDownList("city")*@
                            @Html.DropDownList("Exddlcity", Model.CityList, new { @class = "textfield", @style = "width:270px;height:25px;font:13px;", disabled = "disabled" })
                            &nbsp;&nbsp;&nbsp;<span id="Exlblcity" style="display: none"></span>
                        </td>
                    </tr>
                </table>
                <br />
                <table width="100%" id="tblProcess">
                    <tr id="TableRow7">
                        <td id="TableCell11" width="100%" align="right">
                            <input type="submit" name="ExbtnProcess2" id="ExbtnProcess2" value="Process" class="button"
                                onclick="return ExCognodeProcess();" />
                            &nbsp;
                            <input type="button" class="exclose button" name="Cancel" value="Cancel" />
                        </td>
                    </tr>
                </table>
            </div>
        </div>
                <div id="ExupdNote" title="Process" class="dvLoading" style="display:none;">
        <table id="ExtblBusyMsg" cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
            <tr>
                <th align="center">
                    <img id="imgp" src="~/Images/loading.gif" /><br />
                    <font size="2"><strong>Credit card transaction is under process, it will take few minutes.&nbsp;<br />
                                                                Kindly bear.&nbsp;</strong></font>
                    <br />
                    <font color="#a52a2a" size="2">Do not click either <i><b>Back</b></i> or any other button
                                                                till the process is complete.</font>
                </th>
            </tr>
        </table>
    </div>
                 </td></tr>
               <tr id="extrmsgdiv" style="width:100%;"> <td style="width:100%; text-align:center;">
                   <span>@ViewBag.expdate</span><a id="aclick" href="#" onclick="return exclick();" style="font-weight:bold;">Click here to renewal</a>
                    </td></tr>
        </table>
        
    }
    <script type="text/javascript">
        var objcardtype = "@ViewBag.CardType";
        var objmonth = "@ViewBag.ExipryMonth";
        var objyear = "@ViewBag.ExipryYear";
        if (objcardtype != '') {
            $("#ExCardType option:contains(" + objcardtype + ")").attr('selected', 'selected');
        }
        if (objmonth != '') {
            $("#Exmonth").val(objmonth);
        }
        if (objyear != '') {
            $("#Exyear").val(objyear);
        }
        $(document).ready(function () {

            $('#Img2').mouseover(function () {
                document.getElementById("divCvv").style.zIndex = '1005';
                document.getElementById("divCvv").style.left = '500px';
                document.getElementById("divCvv").style.top = '50px';
                document.getElementById("divCvv").style.position = 'absolute';
                document.getElementById("divCvv").style.display = '';
            });
            $('#Img2').mouseout(function () {

                document.getElementById('divCvv').style.display = 'none';
            });
        });
    </script>
    <script type="text/javascript" language="JavaScript">
        window.history.forward();
    </script>
</body>
    <script type="text/javascript">
        function ExInfoSuccessex(data) {
            if (data != '' & data.Success == true) {
                window.location = '../Schedule/WeeklyAppts';
            }
            else if (data.ErrorMessage == 'expire') {
                window.location.href = '../Home/SessionExpire';
            }
            else {
                $('#updateDialog1editpay').dialog('open');
                document.body.style.cursor = 'pointer';
                document.getElementById("Exdiv10").style.display = '';
                document.getElementById("ExupdNote").style.display = 'none';
                $("#Exupdate-message").html(data.ErrorMessage);
                $("#Exupdate-message").show();
            }
        }
    </script>
</html>
